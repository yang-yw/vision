ORG 0000H
LJMP MAIN

MAIN:;初始化P0，P1
MOV P0,#0FFH
MOV P1,#0FFH

KEYDELAY:;延时、消除按键抖动
MOV P1,#0F0H;11110000
LCALL DELAY
MOV A,P1
CJNE A,#0F0H,KEYSCAN
LJMP KEYDELAY

KEYSCAN:;判断按键所在列
MOV A,P1
CJNE A,#70H,N1;01110000
MOV R4,#00H;0
LJMP NEXT

N1:
CJNE A,#0B0H,N2;10110000
MOV R4,#04H;4
LJMP NEXT
N2:
CJNE A,#0D0H,N3;11010000
MOV R4,#08H;8
LJMP NEXT
N3:
CJNE A,#0E0H,NEXT;11100000
MOV R4,#0CH;12
LJMP NEXT

NEXT:;判断按键所在行
MOV P1,#00FH;00001111
MOV A,P1
CJNE A,#07H,N4;00000111
MOV R3,#03H;3
LJMP NEXT

N4:
CJNE A,#00BH,N5;00001011
MOV R3,#02H;2
LJMP NEXT
N5:
CJNE A,#00DH,N6;00001101
MOV R3,#01H;1
LJMP NEXT
N6:
CJNE A,#00EH,DISPLAY;00001110
MOV R3,#00H;0
LJMP DISPLAY

DISPLAY:;确定按键值并输出
MOV A,R4
ADD A,R3
MOV DPTR,#LEDTAB
MOVC A,@A+DPTR
MOV P0,A
LJMP KEYDELAY

DELAY:;延时函数
MOV R6,#25
D2:
MOV R7,#100
DJNZ R7,$
DJNZ R6,D2
RET
LEDTAB:
DB 0C0H,0F9H,0A4H,0B0H,099H,092H,082H,0F8H,080H,090H,088H,083H,0C6H,0A1H,086H,08EH

END

